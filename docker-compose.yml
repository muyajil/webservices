version: "3"

services:
  # [START] SYNCTHING
  syncthing:
    image: lscr.io/linuxserver/syncthing:latest
    hostname: syncthing.srv.ajil.ch
    environment:
      PUID: 1000
      PGID: 1000
      TZ: Europe/London
      VIRTUAL_HOST: syncthing.${TLD}
      LETSENCRYPT_HOST: syncthing.${TLD}
      VIRTUAL_PORT: 8384
    volumes:
      - ${VOLUMES_PATH}/syncthing/config:/config
      - ${VOLUMES_PATH}/syncthing/photos_landing_zone:/photos_landing_zone
    ports:
      - 22000:22000/tcp
      - 22000:22000/udp
      - 21027:21027/udp
    networks:
      - base-network
    restart: unless-stopped
  # [END] SYNCTHING
  # [START] bitwarden
  bitwarden:
    image: vaultwarden/server:latest
    environment:
      VIRTUAL_HOST: bitwarden.${TLD}
      LETSENCRYPT_HOST: bitwarden.${TLD}
      VIRTUAL_PORT: 80
      SIGNUPS_ALLOWED: "true"
      DOMAIN: https://bitwarden.${TLD}
      ADMIN_TOKEN: ${ADMIN_TOKEN_BITWARDEN}
    volumes:
      - "${VOLUMES_PATH}/bitwarden:/data"
    restart: unless-stopped
    networks:
      - base-network
  # [END] bitwarden
  # [START] file drop  
  filedrop:
    image: muyajil/filedrop:latest
    environment:
      VIRTUAL_HOST: drop.${TLD}
      LETSENCRYPT_HOST: drop.${TLD}
      VIRTUAL_PORT: 5000
    volumes:
      - "${VOLUMES_PATH}/drop:/uploads"
    restart: unless-stopped
    networks:
      - base-network
  # [END] file drop
networks:
  base-network:
    external: true
